### 180. Consecutive Numbers

#### SQL schema
```mysql
Create table If Not Exists Logs (Id int, Num int)
Truncate table Logs
insert into Logs (Id, Num) values ('1', '1')
insert into Logs (Id, Num) values ('2', '1')
insert into Logs (Id, Num) values ('3', '1')
insert into Logs (Id, Num) values ('4', '2')
insert into Logs (Id, Num) values ('5', '1')
insert into Logs (Id, Num) values ('6', '2')
insert into Logs (Id, Num) values ('7', '2')
```

```
Write a SQL query to find all numbers that appear at least three times consecutively.

+----+-----+
| Id | Num |
+----+-----+
| 1  |  1  |
| 2  |  1  |
| 3  |  1  |
| 4  |  2  |
| 5  |  1  |
| 6  |  2  |
| 7  |  2  |
+----+-----+
For example, given the above Logs table, 1 is the only number that appears consecutively for at least three times.

+-----------------+
| ConsecutiveNums |
+-----------------+
| 1               |
+-----------------+
```

### mycode 不会
* **Windows functions** to the rescue. Though this solution is slower for smaller tables, it will work better for larger tables.
* **lag(),lead()**

```mysql
SELECT distinct num ConsecutiveNums
FROM
(SELECT id, num,
lag(num,1) over (order by id) as before,
lead(num,1) over (order by id) as after

FROM logs) 
next_prev
WHERE num=before and before =after
```
* **lag()**
https://www.mysqltutorial.org/mysql-window-functions/mysql-lag-function/
```mysql
LAG(<expression>[,offset[, default_value]]) OVER (
    PARTITION BY expr,...
    ORDER BY expr [ASC|DESC],...
)
```



